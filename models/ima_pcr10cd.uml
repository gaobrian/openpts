<?xml version="1.0" encoding="UTF-8"?>
<uml:Model xmi:version="2.1" xmlns:xmi="http://schema.omg.org/spec/XMI/2.1" xmlns:uml="http://www.eclipse.org/uml2/3.0.0/UML" xmi:id="c04390d2-2776-11e0-8219-001f160c9c28">
  <packagedElement xmi:type="uml:StateMachine" xmi:id="KmZFE1y0" name="">
    <region xmi:id="_XqC-YpSwEdy22t6WWvUZtA" name="kernel">
      <ownedComment xmi:id="L2gSSsT0">
        <body>Old IMA, CD boot (no initrd)</body>
      </ownedComment>

      <subvertex xmi:type="uml:Pseudostate" xmi:id="Start" name="Start"/>

      <subvertex xmi:type="uml:State" xmi:id="CheckOption" name="CheckOption" visibility="public">
        <doActivity xmi:type="uml:Activity" xmi:id="_XqC-Z5SwEdy22t6WWvUZtA" name="validateProperty(linux.kernel.cmdline.ima,1)"/>
      </subvertex>

      <subvertex xmi:type="uml:State" xmi:id="Kernel" name="Kernel" visibility="public">
        <doActivity xmi:type="uml:Activity" xmi:id="_XqC-ZpSwEdy22t6WWvUZtA" name="validateProperty(linux.kernel.digest,digest)"/>
      </subvertex>

      <subvertex xmi:type="uml:State" xmi:id="Initrd" name="Initrd" visibility="public"/>

      <subvertex xmi:type="uml:State" xmi:id="Aggrigate" name="Aggrigate" visibility="public">
        <doActivity xmi:type="uml:Activity" xmi:id="_XqC-ZZSwEdy22t6WWvUZtA" name="validateOldImaAggregate()"/>
      </subvertex>

      <subvertex xmi:type="uml:State" xmi:id="File" name="File" visibility="public">
      </subvertex>

      <subvertex xmi:type="uml:State" xmi:id="File_Exe" name="File_Exe" visibility="public">
        <doActivity xmi:type="uml:Activity" xmi:id="_XqC-ZJSwEdy22t6WWvUZtA_1" name="validateImaMeasurement()"/>
      </subvertex>

      <subvertex xmi:type="uml:State" xmi:id="File_LKM" name="File_LKM" visibility="public">
        <doActivity xmi:type="uml:Activity" xmi:id="_XqC-ZJSwEdy22t6WWvUZtA_2" name="validateImaMeasurement()"/>
      </subvertex>

      <subvertex xmi:type="uml:FinalState" xmi:id="Final"/>

      <transition xmi:id="CheckOption_trans" name="CheckOption_trans" visibility="public" kind="local" source="Start" target="CheckOption"/>

      <transition xmi:id="Kernel_trans" name="Kernel_trans" visibility="public" kind="local" source="CheckOption" target="Kernel"/>

      <transition xmi:id="Initrd_trans" name="Initrd_trans" visibility="public" kind="local" source="Kernel" target="Initrd"/>

      <transition xmi:id="Aggrigate_trans" name="Aggrigate_trans" visibility="public" kind="local" source="Initrd" target="Aggrigate" guard="_XqC-cpSwEdy22t6WWvUZtA">
        <ownedRule xmi:id="_XqC-cpSwEdy22t6WWvUZtA" name="">
          <specification xmi:type="uml:OpaqueExpression" xmi:id="_XqC-c5SwEdy22t6WWvUZtA" name="">
            <body>eventtype == 0x00</body>
          </specification>
        </ownedRule>
      </transition>

      <transition xmi:id="File_trans" name="File_trans" visibility="public" kind="local" source="Aggrigate" target="File"/>

      <transition xmi:id="File_Exe_trans" name="File_Exe_trans" visibility="public" kind="local" source="File" target="File_Exe" guard="_XqC-dZSwEdy22t6WWvUZtA">
        <ownedRule xmi:id="_XqC-dZSwEdy22t6WWvUZtA" name="">
          <specification xmi:type="uml:OpaqueExpression" xmi:id="_XqC-dpSwEdy22t6WWvUZtA" name="">
            <body>eventtype == 0x01</body>
          </specification>
        </ownedRule>
      </transition>

      <transition xmi:id="File_LKM_trans" name="File_LKM_trans" visibility="public" kind="local" source="File" target="File_LKM" guard="_XqC-dZSwEdy22t6WWvUZtA_1">
        <ownedRule xmi:id="_XqC-dZSwEdy22t6WWvUZtA_1" name="">
          <specification xmi:type="uml:OpaqueExpression" xmi:id="_XqC-dpSwEdy22t6WWvUZtA_1" name="">
            <body>eventtype == 0x02</body>
          </specification>
        </ownedRule>
      </transition>

      <transition xmi:id="File_Exe_Loop_trans" name="File_Exe_Loop_trans" visibility="public" kind="local" source="File_Exe" target="File"/>

      <transition xmi:id="File_LKM_Loop_trans" name="File_LKM_Loop_trans" visibility="public" kind="local" source="File_LKM" target="File"/>

      <transition xmi:id="Final_trans" name="Final_trans" visibility="public" kind="local" source="File" target="Final" guard="_XqC-bZSwEdy22t6WWvUZtA">
        <ownedRule xmi:id="_XqC-bZSwEdy22t6WWvUZtA" name="">
          <specification xmi:type="uml:OpaqueExpression" xmi:id="_XqC-bpSwEdy22t6WWvUZtA" name="">
            <body>eventtype == 0xFFFFFFFF</body>
          </specification>
        </ownedRule>
      </transition>
    </region>
  </packagedElement>
</uml:Model>
